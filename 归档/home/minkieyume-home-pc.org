#+TITLE: MinkieYume Home PC

* 介绍
这是通用的个人PC电脑Home环境配置。

* 环境核心配置
#+begin_src scheme :tangle ./minkieyume-home-pc.scm :noweb yes :noweb-prefix no
(use-modules <<module>>)

<<define>>
(define minkieyume-home-pc
  (home-environment
    <<env>>
    (packages (append (specifications->packages (list <<package>>)) <<packages>>))
    (services (cons* <<home-service>> %rosenthal-desktop-home-services))))
#+end_src

** 基础模块
#+begin_src scheme :noweb-ref module
  (gnu)
  (gnu home)
  (gnu home services)
  (gnu home services dotfiles)
  (gnu home services shells)
  (gnu services)
  (gnu packages admin)
  (guix gexp)
  (guix utils)
  (srfi srfi-26)
  (ice-9 match)
  (rosenthal)
#+end_src

#+begin_src scheme :noweb yes :noweb-ref home-service
  (service home-dotfiles-service-type
  	 (home-dotfiles-configuration
  	  (directories '("../files/config/dotfiles"))))
#+end_src

** 环境变量
#+begin_src scheme :noweb yes :noweb-ref home-service :noweb-prefix no
(simple-service 'home-environment-variables
		home-environment-variables-service-type
		`(<<home-environment-variable>>))
#+end_src

* 工具
** Emacs
#+begin_src scheme :noweb-ref packages
(load "../packages/emacs.scm")
#+end_src

#+begin_src scheme :noweb-ref home-environment-variable
  ("EDITOR" . "emacsclient")
  ("VISUAL" . "$EDITOR")
  ("ESHELL" . ,(file-append (spec->pkg "fish") "/bin/fish"))
#+end_src

#+begin_src scheme :noweb-ref home-service
(simple-service 'emacs-configuration
      		home-xdg-configuration-files-service-type
      		`(("emacs/init.el"
      		   ,(computed-substitution-with-inputs "init.el"
      						       (local-file "../files/config/emacs/init.el")
						       (append
							(list (local-file "../files/config/emacs" #:recursive? #t)
							      (local-file "../secret/epasu" #:recursive? #t))
							(specs->pkgs "ccls"
      								     "fish"
      								     "python-lsp-server"
      								     "zig-zls"
    								     "fd"
								     "mpv"
								     "ffmpegthumbnailer"
								     "7zip"
								     "imagemagick"
								     "godot"
								     "mediainfo"
								     "vips"))))
      		  ("emacs/.init-themes.el"
      		   ,(local-file "../files/config/chikoyumemi/init-theme.el"))))
#+end_src

#+begin_src scheme :noweb-ref home-service
  (simple-service 'home-emacs
  		home-shepherd-service-type
  		(list (shepherd-service
  		       (provision '(emacs-daemon))
  		       (start
  			#~(make-forkexec-constructor
  			   '("emacs" "--fg-daemon")))
  		       (stop
  			#~(make-forkexec-constructor
  			   '("emacsclient" "--eval" "(kill-emacs)"))))))
#+end_src

#+begin_src scheme :noweb-ref home-service
  (simple-service 'emacs-auth-info
		home-files-service-type
		`((".authinfo.gpg" ,(local-file "../secret/authinfo.gpg"))))
#+end_src

[[file:../files/config/emacs/Emacs配置.org][Emacs配置]]
